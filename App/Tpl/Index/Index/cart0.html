<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>购物车-{tp#$webinfo['web_name']}</title>

<link href="__PUBLIC__/css/css.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="__PUBLIC__/js/jquery-1.8.2.min.js"></script>
<script type="text/javascript">
<!--
var timeout         = 500;
var closetimer		= 0;
var ddmenuitem      = 0;

// open hidden layer
function mopen(id)
{	
	// cancel close timer
	mcancelclosetime();

	// close old layer
	if(ddmenuitem) ddmenuitem.style.visibility = 'hidden';

	// get new layer and show it
	ddmenuitem = document.getElementById(id);
	ddmenuitem.style.visibility = 'visible';

}
// close showed layer
function mclose()
{
	if(ddmenuitem) ddmenuitem.style.visibility = 'hidden';
}

// go close timer
function mclosetime()
{
	closetimer = window.setTimeout(mclose, timeout);
}

// cancel close timer
function mcancelclosetime()
{
	if(closetimer)
	{
		window.clearTimeout(closetimer);
		closetimer = null;
	}
}

// close layer when click-out
document.onclick = mclose; 
// -->
</script>

<script type="text/javascript" src="__PUBLIC__/js/jquery.min.js"></script>
<script type="text/javascript">

var intDiff = parseInt(60);//倒计时总秒数量

function timer(intDiff){
	window.setInterval(function(){
	var day=0,
		hour=0,
		minute=0,
		second=0;//时间默认值		
	if(intDiff > 0){
		day = Math.floor(intDiff / (60 * 60 * 24));
		hour = Math.floor(intDiff / (60 * 60)) - (day * 24);
		minute = Math.floor(intDiff / 60) - (day * 24 * 60) - (hour * 60);
		second = Math.floor(intDiff) - (day * 24 * 60 * 60) - (hour * 60 * 60) - (minute * 60);
	}
	if (minute <= 9) minute = '0' + minute;
	if (second <= 9) second = '0' + second;
	$('#day_show').html(day+"天");
	$('#hour_show').html('<s id="h"></s>'+hour+'时');
	$('#minute_show').html('<s></s>'+minute+'分');
	$('#second_show').html('<s></s>'+second+'秒');
	intDiff--;
	}, 1000);
} 

$(function(){
	timer(intDiff);
});	
</script>
<script type="text/javascript" src="__PUBLIC__/js/jquery.min.js"></script>
<script src="__PUBLIC__/js/showList.js" type="text/javascript"></script>
<script type="text/javascript" src="__PUBLIC__/js/script.js"></script>
<script type="text/javascript" src="__PUBLIC__/js/tab.js"></script>

<link href="__PUBLIC__/css/style.css" rel="stylesheet" type="text/css" />
<!--<script type="text/javascript" src="__PUBLIC__/js/jquery.1.4.2-min.js"></script>-->
<script type="text/javascript" src="__PUBLIC__/js/Calculation.js"></script>
<script type="text/javascript">
$(document).ready(function () {

	//jquery特效制作复选框全选反选取消(无插件)
	// 全选        
	$(".allselect").click(function () {
		$(".gwc_tb2 input[name=newslist]").each(function () {
			$(this).attr("checked", true);
			// $(this).next().css({ "background-color": "#3366cc", "color": "#ffffff" });
		});
		GetCount();
	});

	//反选
	$("#invert").click(function () {
		$(".gwc_tb2 input[name=newslist]").each(function () {
			if ($(this).attr("checked")) {
				$(this).attr("checked", false);
				//$(this).next().css({ "background-color": "#ffffff", "color": "#000000" });
			} else {
				$(this).attr("checked", true);
				//$(this).next().css({ "background-color": "#3366cc", "color": "#000000" });
			} 
		});
		GetCount();
	});

	//取消
	$("#cancel").click(function () {
		$(".gwc_tb2 input[name=newslist]").each(function () {
			$(this).attr("checked", false);
			// $(this).next().css({ "background-color": "#ffffff", "color": "#000000" });
		});
		GetCount();
	});

	// 所有复选(:checkbox)框点击事件
	$(".gwc_tb2 input[name=newslist]").click(function () {
		if ($(this).attr("checked")) {
			//$(this).next().css({ "background-color": "#3366cc", "color": "#ffffff" });
		} else {
			// $(this).next().css({ "background-color": "#ffffff", "color": "#000000" });
		}
	});

	// 输出
	$(".gwc_tb2 input[name=newslist]").click(function () {
		// $("#total2").html() = GetCount($(this));
		GetCount();
		//layer.alert(conts);
	});
});
//******************
function GetCount() {
	var conts = 0;
	var aa = 0;
	$(".gwc_tb2 input[name=newslist]").each(function () {
		if ($(this).attr("checked")) {
			for (var i = 0; i < $(this).length; i++) {
				conts += parseInt($(this).val());
				aa += 1;
			}
		}
	});
	$("#shuliang").text(aa);
	$("#zong1").html((conts).toFixed(2));
	$("#jz1").css("display", "none");
	$("#jz2").css("display", "block");
}
</script>

</head>

<body>
<include file="Public:top"/>
<div class="main">
        <!--<div class="gg01">
          <center><a href=""><img src="__PUBLIC__/img/top/gg01.jpg"></a></center>
        </div>-->
        <div class="shopcart">
            <div class="shopcert-t">全部商品</div>
            <div class="shopcart">
            
                  <div class="gwc" style=" margin:auto;">
                      <table cellpadding="0" cellspacing="0" class="gwc_tb2" style="padding-top:0">
                          <tr bgcolor="#E7E7E7" height="50">
                              <td class="tb1_td1">
                              <!--<input id="Checkbox1" type="checkbox"  class="allselect"/>-->
                              </td>
                              <td class="tb1_td1"></td>
                              <td class="tb1_td3">商品</td>
                              <td class="tb1_td4">属性</td>
                              <td class="tb1_td5">数量</td>
                              <td class="tb1_td6">单价</td>
                              <td class="tb1_td7">操作</td>
                          </tr>
                      <!--</table>-->
                               
                        <!---商品加减算总数---->
                        <script type="text/javascript">
                        $(function () {
                            var t = $("#text_box1");
                            $("#add1").click(function () {
                                t.val(parseInt(t.val()) + 1)
                                setTotal(); GetCount();
                            })
                            $("#min1").click(function () {
                                t.val(parseInt(t.val()) - 1)
                                setTotal(); GetCount();
                            })
                            function setTotal() {
                    
                                $("#total1").html((parseInt(t.val()) * 9).toFixed(2));
                                $("#newslist-1").val(parseInt(t.val()) * 9);
                            }
                            setTotal();
                        })
                        </script>
						<volist name="list" id="item">
                          <!--<table cellpadding="0" cellspacing="0" class="gwc_tb2">-->
                              <tr>
                                  <td class="tb2_td1">
                                  <!--<input type="checkbox" value="1" name="newslist" id="newslist-1" />-->
                                  </td>
                                  <td class="tb2_td2"><a target="_blank" href="{tp#:U('product',array('id'=>$item['goods_id']))}"><img src="{tp#$item['goods_spic']}" onerror="this.src='__PUBLIC__/images/no-pic.jpg'"/></a></td>
                                  <td class="tb2_td3"><a target="_blank" href="{tp#:U('product',array('id'=>$item['goods_id']))}">{tp#$item['name']}</a></td>
                                  <td class="tb1_td4">
                                       <span>{tp#$item['norm']['title']|default='---'}</span>
                                  </td>
                                  <td class="tb1_td5">
                                      <input id="min1" name=""  style=" width:20px; height:18px;border:1px solid #ccc;" type="button" value="-" />
                                      <input id="text_box1" name="" type="text" value="{tp#$item['goods_nums']|default='1'}" style=" width:30px; text-align:center; border:1px solid #ccc;" />
                                      <input id="add1" name="" style=" width:20px; height:18px;border:1px solid #ccc;" type="button" value="+" />
                                  </td>
                                  <td class="tb1_td6" style="color:#ff5500;font-size:14px; font-weight:bold;">
                                  {tp#$item['goods_price']}
                                  </td>
                                  <td class="tb1_td7"> 
                                  <!--<a href="">移到收藏夹</a><br>-->
                                  <a goods_id="{tp#$item['goods_id']}" goods_norm="{tp#$item['norm']['id']}" cart_key="{tp#$key}" class="btn btn-del">删除</a></td>
                              </tr>
                          
                          </volist>
                          </table>
                          <!---商品加减算总数---->
                          <script type="text/javascript">
                          $(function () {
                              var t = $("#text_box2");
                              $("#add2").click(function () {
                                  t.val(parseInt(t.val()) + 1)
                                  setTotal(); GetCount();
                              })
                              $("#min2").click(function () {
                                  t.val(parseInt(t.val()) - 1)
                                  setTotal(); GetCount();
                              })
                              function setTotal() {
                      
                                  $("#total2").html((parseInt(t.val()) * 8).toFixed(2));
                                  $("#newslist-2").val(parseInt(t.val()) * 8);
                              }
                              setTotal();
                          })
                          </script>

                          <!---总数---->
                          <script type="text/javascript">
                          $(function () {
                              $(".quanxun").click(function () {
                                  setTotal();
                                  //layer.alert($(lens[0]).text());
                              });
                              function setTotal() {
                                  var len = $(".tot");
                                  var num = 0;
                                  for (var i = 0; i < len.length; i++) {
                                      num = parseInt(num) + parseInt($(len[i]).text());
                      
                                  }
                                  //layer.alert(len.length);
                                  $("#zong1").text(parseInt(num).toFixed(2));
                                  $("#shuliang").text(len.length);
                              }
                              //setTotal();
                          })
                           </script>
                         


                   </div>
            </div>
        </div>
       
 </div>

 <!--bottom-->
	<include file="Public:foot"/>
 <!--bottom-->
</body>
<script>
$(function(){
	//删除购物车
	$(".btn-del").click(function(){
		if(confirm("确定移除吗？")){
			var obj = $(this);
			//var cart_count = $('.mycarts').html();			//购物车中商品总数
			
			var post_data={}; 
			post_data.goods_id=$(this).attr('goods_id');
			post_data.goods_norm=$(this).attr('goods_norm');
			post_data.cart_key=$(this).attr('cart_key');
			
			$.post("{tp#:U('Weixin/Ajax/delcart')}",post_data,function(data){
				if(data==1){
					obj.parent().parent().remove();
					//number = $(obj).parent().parent().find('input[name="goods_number"]').val();
					//$('.mycarts').html(parseInt(cart_count)-parseInt(number));
				}																					
			});
			
		}
		return false;
	});
});
</script>
</html>
